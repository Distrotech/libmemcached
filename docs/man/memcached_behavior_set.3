.TH "MEMCACHED_BEHAVIOR_SET" "3" "April 09, 2011" "0.47" "libmemcached"
.SH NAME
memcached_behavior_set \- libmemcached Documentation
.
.nr rst2man-indent-level 0
.
.de1 rstReportMargin
\\$1 \\n[an-margin]
level \\n[rst2man-indent-level]
level margin: \\n[rst2man-indent\\n[rst2man-indent-level]]
-
\\n[rst2man-indent0]
\\n[rst2man-indent1]
\\n[rst2man-indent2]
..
.de1 INDENT
.\" .rstReportMargin pre:
. RS \\$1
. nr rst2man-indent\\n[rst2man-indent-level] \\n[an-margin]
. nr rst2man-indent-level +1
.\" .rstReportMargin post:
..
.de UNINDENT
. RE
.\" indent \\n[an-margin]
.\" old: \\n[rst2man-indent\\n[rst2man-indent-level]]
.nr rst2man-indent-level -1
.\" new: \\n[rst2man-indent\\n[rst2man-indent-level]]
.in \\n[rst2man-indent\\n[rst2man-indent-level]]u
..
.\" Man page generated from reStructeredText.
.
.sp
Manipulate behavior
.SH LIBRARY
.sp
C Client Library for memcached (libmemcached, \-lmemcached)
.SS SYNOPSIS
.sp
.nf
.ft C
#include <libmemcached/memcached.h>

uint64_t
  memcached_behavior_get (memcached_st *ptr,
                          memcached_behavior flag);

memcached_return_t
  memcached_behavior_set (memcached_st *ptr,
                          memcached_behavior flag,
                          uint64_t data);
.ft P
.fi
.SS DESCRIPTION
.sp
libmemcached(3) behavior can be modified by use memcached_behavior_set().
Default behavior is the library strives to be quick and accurate. Some
behavior, while being faster, can also result in not entirely accurate
behavior (for instance, memcached_set() will always respond with
\fBMEMCACHED_SUCCESS\fP).
.sp
memcached_behavior_get() takes a behavior flag and returns whether or not
that behavior is currently enabled in the client.
.sp
memcached_behavior_set() changes the value of a particular option of the
client. It takes both a flag (listed below) and a value. For simple on or
off options you just need to pass in a value of 1. Calls to
memcached_behavior_set() will flush and reset all connections.
.sp
MEMCACHED_BEHAVIOR_USE_UDP
.INDENT 0.0
.INDENT 3.5
.sp
Causes libmemcached(3) to use the UDP transport when communicating
with a memcached server. Not all I/O operations are testsed
when this behavior is enababled. The following operations will return
\fBMEMCACHED_NOT_SUPPORTED\fP when executed with the MEMCACHED_BEHAVIOR_USE_UDP
enabled: memcached_version(), memcached_stat(), memcached_get(),
memcached_get_by_key(), memcached_mget(), memcached_mget_by_key(),
memcached_fetch(), memcached_fetch_result(), memcached_value_fetch().
.sp
All other operations are testsed but are executed in a \(aqfire\-and\-forget\(aq
mode, in which once the client has executed the operation, no attempt
will be made to ensure the operation has been received and acted on by the
server.
.sp
libmemcached(3) does not allow TCP and UDP servers to be shared within
the same libmemached(3) client \(aqinstance\(aq. An attempt to add a TCP server
when this behavior is enabled will result in a \fBMEMCACHED_INVALID_HOST_PROTOCOL\fP,
as will attempting to add a UDP server when this behavior has not been enabled.
.UNINDENT
.UNINDENT
.sp
MEMCACHED_BEHAVIOR_NO_BLOCK
.INDENT 0.0
.INDENT 3.5
.sp
Causes libmemcached(3) to use asychronous IO. This is the fastest transport
available for storage functions.
.UNINDENT
.UNINDENT
.sp
MEMCACHED_BEHAVIOR_SND_TIMEOUT
.INDENT 0.0
.INDENT 3.5
.sp
This sets the microsecond behavior of the socket against the SO_SNDTIMEO flag.
In cases where you cannot use non\-blocking IO this will allow you to still have
timeouts on the sending of data.
.UNINDENT
.UNINDENT
.sp
MEMCACHED_BEHAVIOR_RCV_TIMEOUT
.INDENT 0.0
.INDENT 3.5
.sp
This sets the microsecond behavior of the socket against the SO_RCVTIMEO flag.
In cases where you cannot use non\-blocking IO this will allow you to still have
timeouts on the reading of data.
.UNINDENT
.UNINDENT
.sp
MEMCACHED_BEHAVIOR_TCP_NODELAY
.INDENT 0.0
.INDENT 3.5
.sp
Turns on the no\-delay feature for connecting sockets (may be faster in some
environments).
.UNINDENT
.UNINDENT
.sp
MEMCACHED_BEHAVIOR_HASH
.INDENT 0.0
.INDENT 3.5
.sp
Makes the default hashing algorithm for keys use MD5. The value can be set
to either MEMCACHED_HASH_DEFAULT, MEMCACHED_HASH_MD5, MEMCACHED_HASH_CRC, MEMCACHED_HASH_FNV1_64, MEMCACHED_HASH_FNV1A_64, MEMCACHED_HASH_FNV1_32, MEMCACHED_HASH_FNV1A_32, MEMCACHED_HASH_JENKINS, MEMCACHED_HASH_HSIEH, and MEMCACHED_HASH_MURMUR.
Each hash has it\(aqs advantages and it\(aqs weaknesses. If you don\(aqt know or don\(aqt care, just go with the default.
Support for MEMCACHED_HASH_HSIEH is a compile time option that is disabled by default. To enable tests for this hashing algorithm, configure and build libmemcached with the \-\-enable\-hash_hsieh.
.UNINDENT
.UNINDENT
.sp
MEMCACHED_BEHAVIOR_DISTRIBUTION
.INDENT 0.0
.INDENT 3.5
.sp
Using this you can enable different means of distributing values to servers.
The default method is MEMCACHED_DISTRIBUTION_MODULA. You can enable
consistent hashing by setting MEMCACHED_DISTRIBUTION_CONSISTENT.
Consistent hashing delivers better distribution and allows servers to be
added to the cluster with minimal cache losses. Currently
MEMCACHED_DISTRIBUTION_CONSISTENT is an alias for the value
MEMCACHED_DISTRIBUTION_CONSISTENT_KETAMA.
.UNINDENT
.UNINDENT
.sp
MEMCACHED_BEHAVIOR_CACHE_LOOKUPS
.INDENT 0.0
.INDENT 3.5
.sp
Memcached can cache named lookups so that DNS lookups are made only once.
.UNINDENT
.UNINDENT
.sp
MEMCACHED_BEHAVIOR_SUPPORT_CAS
.INDENT 0.0
.INDENT 3.5
.sp
Support CAS operations (this is not enabled by default at this point in the server since it imposes a slight performance penalty).
.UNINDENT
.UNINDENT
.sp
MEMCACHED_BEHAVIOR_KETAMA
.INDENT 0.0
.INDENT 3.5
.sp
Sets the default distribution to MEMCACHED_DISTRIBUTION_CONSISTENT_KETAMA
and the hash to MEMCACHED_HASH_MD5.
.UNINDENT
.UNINDENT
.sp
MEMCACHED_BEHAVIOR_KETAMA_WEIGHTED
.INDENT 0.0
.INDENT 3.5
.sp
Sets the default distribution to MEMCACHED_DISTRIBUTION_CONSISTENT_KETAMA with the weighted tests.
and the hash to MEMCACHED_HASH_MD5.
.UNINDENT
.UNINDENT
.sp
MEMCACHED_BEHAVIOR_KETAMA_HASH
.INDENT 0.0
.INDENT 3.5
.sp
Sets the hashing algorithm for host mapping on continuum. The value can be set
to either MEMCACHED_HASH_DEFAULT, MEMCACHED_HASH_MD5, MEMCACHED_HASH_CRC, MEMCACHED_HASH_FNV1_64, MEMCACHED_HASH_FNV1A_64, MEMCACHED_HASH_FNV1_32, and MEMCACHED_HASH_FNV1A_32.
.UNINDENT
.UNINDENT
.sp
MEMCACHED_BEHAVIOR_KETAMA_COMPAT
.INDENT 0.0
.INDENT 3.5
.sp
Sets the compatibility mode. The value can be set to either
MEMCACHED_KETAMA_COMPAT_LIBMEMCACHED (this is the default) or
MEMCACHED_KETAMA_COMPAT_SPY to be compatible with the SPY Memcached client
for Java.
.UNINDENT
.UNINDENT
.sp
MEMCACHED_BEHAVIOR_POLL_TIMEOUT
.INDENT 0.0
.INDENT 3.5
.sp
Modify the timeout value that is used by poll(). The default value is \-1. An signed int pointer must be passed to memcached_behavior_set() to change this value. For memcached_behavior_get() a signed int value will be cast and returned as the unsigned long long.
.UNINDENT
.UNINDENT
.sp
MEMCACHED_BEHAVIOR_USER_DATA
.INDENT 0.0
.INDENT 3.5
.sp
This allows you to store a pointer to a specifc piece of data. This can be
retrieved from inside of memcached_fetch_execute(). Cloning a memcached_st
.sp
will copy the pointer to the clone. This was deprecated in 0.14 in favor
of memcached_callback_set(3). This will be removed in 0.15.
.UNINDENT
.UNINDENT
.sp
MEMCACHED_BEHAVIOR_BUFFER_REQUESTS
.INDENT 0.0
.INDENT 3.5
.sp
Enabling buffered IO causes commands to "buffer" instead of being sent. Any
action that gets data causes this buffer to be be sent to the remote
connection. Quiting the connection or closing down the connection will also
cause the buffered data to be pushed to the remote connection.
.UNINDENT
.UNINDENT
.sp
MEMCACHED_BEHAVIOR_VERIFY_KEY
.INDENT 0.0
.INDENT 3.5
.sp
Enabling this will cause libmemcached(3) to test all keys to verify that they
are valid keys.
.UNINDENT
.UNINDENT
.sp
MEMCACHED_BEHAVIOR_SORT_HOSTS
.INDENT 0.0
.INDENT 3.5
.sp
Enabling this will cause hosts that are added to be placed in the host list in
sorted order. This will defeat consisten hashing.
.UNINDENT
.UNINDENT
.sp
MEMCACHED_BEHAVIOR_CONNECT_TIMEOUT
.INDENT 0.0
.INDENT 3.5
.sp
In non\-blocking mode this changes the value of the timeout during socket
connection.
.UNINDENT
.UNINDENT
.sp
MEMCACHED_BEHAVIOR_BINARY_PROTOCOL
.INDENT 0.0
.INDENT 3.5
.sp
Enable the use of the binary protocol. Please note that you cannot toggle
this flag on an open connection.
.UNINDENT
.UNINDENT
.sp
MEMCACHED_BEHAVIOR_SERVER_FAILURE_LIMIT
.INDENT 0.0
.INDENT 3.5
.sp
Set this value to enable the server be removed after continuous MEMCACHED_BEHAVIOR_SERVER_FAILURE_LIMIT
times connection failure.
.UNINDENT
.UNINDENT
.sp
MEMCACHED_BEHAVIOR_IO_MSG_WATERMARK
.INDENT 0.0
.INDENT 3.5
.sp
Set this value to tune the number of messages that may be sent before
libmemcached should start to automatically drain the input queue. Setting
this value to high, may cause libmemcached to deadlock (trying to send data,
but the send will block because the input buffer in the kernel is full).
.UNINDENT
.UNINDENT
.sp
MEMCACHED_BEHAVIOR_IO_BYTES_WATERMARK
.INDENT 0.0
.INDENT 3.5
.sp
Set this value to tune the number of bytes that may be sent before
libmemcached should start to automatically drain the input queue (need
at least 10 IO requests sent without reading the input buffer). Setting
this value to high, may cause libmemcached to deadlock (trying to send
data, but the send will block because the input buffer in the kernel is full).
.UNINDENT
.UNINDENT
.sp
MEMCACHED_BEHAVIOR_IO_KEY_PREFETCH
.INDENT 0.0
.INDENT 3.5
.sp
The binary protocol works a bit different than the textual protocol in
that a multiget is implemented as a pipe of single get\-operations which
are sent to the server in a chunk. If you are using large multigets from
your application, you may improve the latency of the gets by setting
this value so you send out the first chunk of requests when you hit the
specified limit.  It allows the servers to start processing the requests
to send the data back while the rest of the requests are created and
sent to the server.
.UNINDENT
.UNINDENT
.sp
MEMCACHED_BEHAVIOR_NOREPLY
.INDENT 0.0
.INDENT 3.5
.sp
Set this value to specify that you really don\(aqt care about the result
from your storage commands (set, add, replace, append, prepend).
.UNINDENT
.UNINDENT
.sp
MEMCACHED_BEHAVIOR_NUMBER_OF_REPLICAS
.INDENT 0.0
.INDENT 3.5
.sp
If you just want "a poor mans HA", you may specify the numbers of
replicas libmemcached should store of each item (on different servers).
This replication does not dedicate certain memcached servers to store the
replicas in, but instead it will store the replicas together with all of the
other objects (on the \(aqn\(aq next servers specified in your server list).
.UNINDENT
.UNINDENT
.sp
MEMCACHED_BEHAVIOR_RANDOMIZE_REPLICA_READ
.INDENT 0.0
.INDENT 3.5
.sp
Allows randomizing the replica reads starting point. Normally the read is
done from primary server and in case of miss the read is done from primary
+ 1, then primary + 2 all the way to \(aqn\(aq replicas. If this option is set
on the starting point of the replica reads is randomized between the servers.
This allows distributing read load to multiple servers with the expense of
more write traffic.
.UNINDENT
.UNINDENT
.sp
MEMCACHED_BEHAVIOR_CORK
.INDENT 0.0
.INDENT 3.5
.sp
Enable TCP_CORK behavior. This is only available as an option Linux.
MEMCACHED_NO_SERVERS is returned if no servers are available to test with.
MEMCACHED_NOT_SUPPORTED is returned if we were not able to determine
if tests was available. All other responses then MEMCACHED_SUCCESS
report an error of some sort. This behavior also enables
MEMCACHED_BEHAVIOR_TCP_NODELAY when set.
.UNINDENT
.UNINDENT
.sp
MEMCACHED_BEHAVIOR_KEEPALIVE
.INDENT 0.0
.INDENT 3.5
.sp
Enable TCP_KEEPALIVE behavior.
.UNINDENT
.UNINDENT
.sp
MEMCACHED_BEHAVIOR_KEEPALIVE_IDLE
.INDENT 0.0
.INDENT 3.5
.sp
Specify time, in seconds, to mark a connection as idle. This is only available as an option Linux.
.UNINDENT
.UNINDENT
.sp
MEMCACHED_BEHAVIOR_SOCKET_SEND_SIZE
.INDENT 0.0
.INDENT 3.5
.sp
Find the current size of SO_SNDBUF. A value of 0 means either an error
occured or no hosts were available. It is safe to assume system default
if this occurs. If an error occurs you can checked the last cached errno statement to find the specific error.
.UNINDENT
.UNINDENT
.sp
MEMCACHED_BEHAVIOR_SOCKET_RECV_SIZE
.INDENT 0.0
.INDENT 3.5
.sp
Find the current size of SO_RCVBUF. A value of 0 means either an error
occured or no hosts were available. It is safe to assume system default
if this occurs. If an error occurs you can checked the last cached errno statement to find the specific error.
.UNINDENT
.UNINDENT
.sp
MEMCACHED_BEHAVIOR_SERVER_FAILURE_LIMIT
.INDENT 0.0
.INDENT 3.5
.sp
This number of times a host can have an error before it is disabled.
.UNINDENT
.UNINDENT
.sp
MEMCACHED_BEHAVIOR_AUTO_EJECT_HOSTS
.INDENT 0.0
.INDENT 3.5
.sp
If enabled any hosts which have been flagged as disabled will be removed
from the list of servers in the memcached_st structure. This must be used
in combination with MEMCACHED_BEHAVIOR_SERVER_FAILURE_LIMIT.
.UNINDENT
.UNINDENT
.sp
MEMCACHED_BEHAVIOR_RETRY_TIMEOUT
.INDENT 0.0
.INDENT 3.5
.sp
When enabled a host which is problematic will only be checked for usage
based on the amount of time set by this behavior.
.UNINDENT
.UNINDENT
.sp
MEMCACHED_BEHAVIOR_HASH_WITH_PREFIX_KEY
.INDENT 0.0
.INDENT 3.5
.sp
When enabled the prefix key will be added to the key when determining
server by hash.
.UNINDENT
.UNINDENT
.SH RETURN
.sp
memcached_behavior_get() returns either the current value of the get, or 0
or 1 on simple flag behaviors (1 being enabled). memcached_behavior_set()
returns failure or success.
.SH NOTES
.sp
memcached_behavior_set() in version .17 was changed from taking a pointer
to data value, to taking a uin64_t.
.SH HOME
.sp
To find out more information please check:
\fI\%https://launchpad.net/libmemcached\fP
.SH AUTHOR
.sp
Brian Aker, <\fI\%brian@tangent.org\fP>
.SS SEE ALSO
.sp
\fImemcached(1)\fP \fIlibmemcached(3)\fP \fImemcached_strerror(3)\fP
.SH AUTHOR
Brian Aker
.SH COPYRIGHT
2011, Brian Aker DataDifferential, http://datadifferential.com/
.\" Generated by docutils manpage writer.
.\" 
.
